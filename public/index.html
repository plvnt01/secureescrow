<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>SecureEscrow — Secure payments made simple</title>
<meta name="description" content="Start an escrow transaction in minutes. Neutral third‑party holds funds until both sides are satisfied." />
<link rel="icon" href="logo.png" />
<style>
  :root{--blue1:#0d6efd;--blue2:#0a58ca;--ink:#0f172a;--muted:#475569;--accent:#10b981;--card:#ffffff;--line:#e5e7eb;--ring:#60a5fa;--error:#ef4444}
  *,*::before,*::after{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:System-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;color:var(--ink);background:#f8fafc}

  .nav{max-width:1100px;margin:0 auto;padding:10px 16px;display:flex;align-items:center;justify-content:space-between}
  .brand{display:flex;align-items:center;gap:10px}
  .brand img{height:28px}
  .brand strong{font-size:18px;color:#083b92;letter-spacing:.2px}
  .navlinks{display:flex;gap:14px}
  .navlinks a{font-size:14px;color:#0b3a91;text-decoration:none;padding:8px;border-radius:8px}
  .navlinks a:hover{background:#eaf2ff}

  .hero{background:linear-gradient(180deg,var(--blue1),var(--blue2));color:#fff;padding:28px 16px 74px;text-align:center}
  .hero h1{margin:6px 0 8px;line-height:1.2;font-size:28px}
  .hero p{margin:0;color:#eaf2ff;opacity:.96}

  .wrap{max-width:1100px;margin:-44px auto 24px;padding:0 16px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 14px 30px rgba(2,8,20,.18);overflow:hidden}
  .card-body{padding:16px}
  .section-title{margin:8px 0 12px;text-align:center;color:#153a8a;font-weight:800}

  .progress{display:flex;gap:6px;justify-content:center;margin:6px 0 10px}
  .dot{width:8px;height:8px;border-radius:999px;background:#cbd5e1;opacity:.8}
  .dot.active{background:var(--accent);opacity:1}

  label{display:block;margin:10px 0 6px;font-weight:600;color:#334155}
  input,select,textarea{width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--line);background:#fff;font-size:16px;outline:none;transition:border-color .15s,box-shadow .15s}
  input:focus,select:focus,textarea:focus{border-color:var(--ring);box-shadow:0 0 0 3px rgba(96,165,250,.25)}
  textarea{resize:vertical;min-height:96px}
  .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:520px){.grid-2{grid-template-columns:1fr}}

  .nav-row{display:flex;gap:12px;margin-top:16px}
  .btn{flex:1 1 0;padding:12px 14px;border-radius:10px;border:1px solid #dbe3f0;background:#1d4ed8;color:#fff;font-weight:800;font-size:16px;letter-spacing:.2px;cursor:pointer;text-decoration:none;text-align:center}
  .btn.secondary{background:#f1f5f9;color:#0f172a}
  .btn.success{background:var(--accent);border-color:#0ea371}
  .btn[disabled]{opacity:.6;cursor:not-allowed}
  .btn:hover:not([disabled]){filter:brightness(1.05)}

  .step{display:none}
  .step.active{display:block}

  .reviews{background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 26px rgba(2,8,20,.12);margin:16px 0;padding:16px}
  .reviews h3{margin:4px 0 10px;text-align:center;color:#133b82}
  .carousel{display:grid;gap:12px;grid-template-columns:repeat(3,1fr)}
  @media(max-width:820px){.carousel{grid-template-columns:1fr}}
  .review{background:#f9fbff;border:1px solid #e5e7eb;border-radius:12px;padding:14px}
  .stars{color:#f59e0b;letter-spacing:2px;font-size:18px}
  .name{font-weight:800;margin-top:8px}.meta{color:#64748b;font-size:13px}
  /* Reviews extras */
  .review-stats{display:grid;gap:12px;grid-template-columns:220px 1fr;align-items:center;margin:6px 0 14px}
  @media(max-width:820px){.review-stats{grid-template-columns:1fr}}
  .avg{font-size:34px;font-weight:800;color:#153a8a}
  .bars{display:grid;gap:6px}
  .bar{display:flex;gap:8px;align-items:center}
  .bar .lbl{width:40px;color:#475569;font-size:13px}
  .bar .track{flex:1;height:10px;background:#eef2ff;border-radius:999px;overflow:hidden}
  .bar .fill{height:100%;background:#10b981}
  .review-form{margin-top:14px;border-top:1px solid #e5e7eb;padding-top:12px}
  .rating-input{display:flex;gap:6px}
  .starbtn{font-size:20px;cursor:pointer;user-select:none}
  .starbtn[aria-checked="true"]{color:#f59e0b}

  .footer{background:linear-gradient(180deg,#0a4e86,#083c65);color:#cfe6ff;padding:28px 16px;border-top:1px solid rgba(255,255,255,.12);margin-top:20px}
  .footer-grid{max-width:1100px;margin:0 auto;display:grid;gap:24px;grid-template-columns:repeat(3,1fr)}
  .footer h4{font-size:14px;letter-spacing:.3px;font-weight:800;color:#e9f3ff;margin:0 0 8px}
  .divider{height:1px;background:rgba(255,255,255,.18);margin:8px 0 10px}
  .footer a{display:block;color:#d5e9ff;text-decoration:none;padding:6px 0;font-size:14px}
  .footer a:hover{color:#fff}
  @media (max-width:820px){.footer-grid{grid-template-columns:1fr}}
  .legal{max-width:1100px;margin:10px auto 0;padding:0 16px;color:#cfe6ff;font-size:12px;opacity:.9;text-align:center}max-width:1100px;margin:10px auto 0;padding:0 16px;color:#cfe6ff;font-size:12px;opacity:.9;text-align:center}
</style>
</head>
<body>

<header class="nav" aria-label="Primary">
  <div class="brand">
    <img src="logo.png" alt="SecureEscrow logo" onerror="this.style.display='none'">
    <strong>SecureEscrow</strong>
  </div>
  <nav class="navlinks" aria-label="Site">
    <a href="#start" id="startLink">Start</a>
    <a href="#reviews-section">Reviews</a>
  </nav>
</header>

<section class="hero">
  <h1>Never buy or sell online without escrow</h1>
  <p>Fast, simple, and secure. Funds are held by a neutral third‑party until both sides are satisfied.</p>
</section>

<main class="wrap" id="start">
  <section class="card" aria-label="Start a secure transaction">
    <div class="card-body">
      <div class="progress" id="dots" aria-hidden="true" aria-label="Progress">
        <div class="dot active"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
      </div>

      <!-- Step 0 -->
      <div class="step active" id="step0">
        <h3 class="section-title">Start a Secure Transaction</h3>
        <p class="muted" style="text-align:center;color:#475569">We’ll guide you through a few short steps.</p>
        <div class="nav-row" style="max-width:420px;margin:14px auto 0">
          <button class="btn success" id="startBtn" type="button">Get started now</button>
        </div>
      </div>

      <!-- Step 1: Role & Source -->
      <div class="step" id="step1">
        <h3 class="section-title">Your Role & Source</h3>
        <div class="grid-2">
          <div>
            <label for="role">I am a…</label>
            <select id="role" required>
              <option value="">Select</option>
              <option>Buyer</option>
              <option>Seller</option>
            </select>
          </div>
          <div>
            <label for="source">Transaction source</label>
            <select id="source">
              <option value="">Select</option>
              <option>Facebook Marketplace</option>
              <option>eBay</option>
              <option>Craigslist</option>
              <option>OfferUp</option>
              <option>Other</option>
            </select>
          </div>
        </div>
        <div class="nav-row">
          <button class="btn secondary" type="button" data-back>← Back</button>
          <button class="btn" type="button" data-next>Next →</button>
        </div>
      </div>

      <!-- Step 2: Personal -->
      <div class="step" id="step2">
        <h3 class="section-title">Personal Information</h3>
        <div class="grid-2">
          <div><label for="firstName">First Name</label><input id="firstName" placeholder="John" required></div>
          <div><label for="lastName">Last Name</label><input id="lastName" placeholder="Doe" required></div>
        </div>
        <label for="email">Email</label><input id="email" type="email" placeholder="john.doe@example.com" required>
        <label for="phone">Phone</label><input id="phone" type="tel" placeholder="(555) 123-4567" required>
        <div class="nav-row">
          <button class="btn secondary" type="button" data-back>← Back</button>
          <button class="btn" type="button" data-next>Next →</button>
        </div>
      </div>

      <!-- Step 3: Transaction Details (simplified, no packages or amounts) -->
      <div class="step" id="step3">
        <h3 class="section-title">Transaction Details</h3>
        <label for="itemDetails">Item / Service</label>
        <textarea id="itemDetails" placeholder="Describe what’s being bought or sold…"></textarea>
        <div class="nav-row">
          <button class="btn secondary" type="button" data-back>← Back</button>
          <button class="btn" type="button" data-next>Next →</button>
        </div>
      </div>

      <!-- Step 4: Confirmation -->
      <div class="step" id="step4">
        <h3 class="section-title">Confirmation</h3>
        <p style="text-align:center;color:#475569">Once the buyer completes payment, the funds will be securely held in escrow and released only when the buyer confirms they are satisfied.</p>
        <div class="nav-row">
          <button class="btn secondary" type="button" data-back>← Back</button>
          <button class="btn success" type="button" id="submitBtn">Finish</button>
        </div>
      </div>

      <!-- Step 5: Done -->
      <div class="step" id="step5">
        <div style="text-align:center;padding:20px">
          <div style="font-size:48px;color:var(--accent)">✓</div>
          <h3 class="section-title">Submission Received</h3>
          <p style="color:#475569">Thanks! We’ve recorded your request. An order ID will be shared for the buyer to reference when making payment.</p>
        </div>
      </div>

    </div>
  </section>

  <section class="reviews" id="reviews-section" aria-label="Customer reviews">
    <h3>Reviews from U.S. customers</h3>
    <div class="review-stats" id="reviewStats">
      <div>
        <div class="avg" id="avgScore">5.0</div>
        <div class="meta" id="reviewCount">Based on 0 reviews</div>
      </div>
      <div class="bars">
        <div class="bar"><span class="lbl">5★</span><div class="track"><div class="fill" id="bar5" style="width:0%"></div></div></div>
        <div class="bar"><span class="lbl">4★</span><div class="track"><div class="fill" id="bar4" style="width:0%"></div></div></div>
        <div class="bar"><span class="lbl">3★</span><div class="track"><div class="fill" id="bar3" style="width:0%"></div></div></div>
        <div class="bar"><span class="lbl">2★</span><div class="track"><div class="fill" id="bar2" style="width:0%"></div></div></div>
        <div class="bar"><span class="lbl">1★</span><div class="track"><div class="fill" id="bar1" style="width:0%"></div></div></div>
      </div>
    </div>
    <div class="carousel" id="reviews"></div>

    <form class="review-form" id="reviewForm" novalidate>
      <h4 style="margin:12px 0 6px;color:#153a8a">Leave a review</h4>
      <div class="grid-2">
        <div>
          <label for="revName">Your name & city/state</label>
          <input id="revName" placeholder="e.g., Jordan Lee (Phoenix, AZ)" required>
        </div>
        <div>
          <label for="revRole">Role</label>
          <select id="revRole">
            <option>Buyer</option>
            <option>Seller</option>
          </select>
        </div>
      </div>
      <label>Rating</label>
      <div class="rating-input" id="revStars" role="radiogroup" aria-label="Rating out of 5">
        <span class="starbtn" role="radio" tabindex="0" data-v="1" aria-checked="false">★</span>
        <span class="starbtn" role="radio" tabindex="0" data-v="2" aria-checked="false">★</span>
        <span class="starbtn" role="radio" tabindex="0" data-v="3" aria-checked="false">★</span>
        <span class="starbtn" role="radio" tabindex="0" data-v="4" aria-checked="false">★</span>
        <span class="starbtn" role="radio" tabindex="0" data-v="5" aria-checked="true">★</span>
      </div>
      <label for="revText">Your comments</label>
      <textarea id="revText" placeholder="Share your experience…" required></textarea>
      <div class="nav-row" style="max-width:420px">
        <button class="btn" type="submit">Post review</button>
      </div>
      <div class="meta" style="margin-top:6px;color:#64748b">By posting, you agree your review may be displayed publicly. We may verify purchase to mark reviews as “Verified customer.”</div>
    </form>
  </section>
</main>

<footer class="footer">
  <div class="footer-grid">
    <div>
      <h4>ESCROW SERVICES</h4><div class="divider"></div>
      <a href="#">Vehicle escrow</a>
      <a href="#">Domain & website escrow</a>
      <a href="#">General merchandise escrow</a>
      <a href="#">Milestone escrow</a>
    </div>
    <div>
      <h4>SUPPORT</h4><div class="divider"></div>
      <a href="#">Fee calculator</a>
      <a href="#">Payment options</a>
      <a href="#">Security</a>
      <a href="#">Fraud prevention</a>
    </div>
    <div>
      <h4>PARTNERS</h4><div class="divider"></div>
      <a href="#">Benefits</a>
      <a href="#">Get started</a>
      <a href="#">API guide</a>
    </div>
  </div>
  <div class="legal">© <span id="yr"></span> SecureEscrow. All rights reserved • Global service.</div>
</footer>

<script>
const steps = [...document.querySelectorAll('.step')];
const dots  = [...document.querySelectorAll('#dots .dot')];
let currentStep = 0;

function showStep(n){
  currentStep=n;
  steps.forEach((el,i)=> el.classList.toggle('active', i===n));
  dots.forEach((d,i)=> d.classList.toggle('active', i < Math.min(4, n===0?1:n)));
}

document.getElementById('startBtn').addEventListener('click', ()=> showStep(1));
document.getElementById('startLink').addEventListener('click', e=>{ e.preventDefault(); showStep(1); });

document.body.addEventListener('click', (e)=>{
  if(e.target.matches('[data-next]')) showStep(currentStep+1);
  if(e.target.matches('[data-back]')) showStep(currentStep-1);
});

<script>
/* ---------- API base: local vs Render ---------- */
const API_BASE = location.hostname.includes('localhost')
  ? 'http://localhost:3000'
  : 'https://secureescrow.onrender.com';

/* ---------- state & element refs ---------- */
const S = {
  step: 0,
  role: '', source: '',
  firstName: '', lastName: '', email: '', phone: '',
  itemDetails: '',
  orderId: ''
};

const steps = [...document.querySelectorAll('.step')];
const dots  = [...document.querySelectorAll('#dots .dot')];

const roleEl       = document.getElementById('role');
const sourceEl     = document.getElementById('source');
const firstNameEl  = document.getElementById('firstName');
const lastNameEl   = document.getElementById('lastName');
const emailEl      = document.getElementById('email');
const phoneEl      = document.getElementById('phone');
const itemDetailsEl= document.getElementById('itemDetails');
const orderSummary = document.getElementById('orderSummary');

/* ---------- ui helpers ---------- */
function showStep(n){
  S.step = Math.max(0, Math.min(5, n));
  steps.forEach((el,i)=> el.classList.toggle('active', i===S.step));
  dots.forEach((d,i)=> d.classList.toggle('active', i < Math.min(4, S.step===0?1:S.step)));
}
function toast(msg){ try{ alert(msg); }catch(_){} }

document.getElementById('startBtn').addEventListener('click', ()=> showStep(1));
document.getElementById('startLink').addEventListener('click', e=>{ e.preventDefault(); showStep(1); });

document.body.addEventListener('click', (e)=>{
  if(e.target.matches('[data-next]')){ if(!validateStep(S.step)) return; showStep(S.step+1); }
  if(e.target.matches('[data-back]')) showStep(S.step-1);
});

/* ---------- validation per step ---------- */
function validateStep(step){
  if(step===1){
    const r = roleEl.value.trim();
    const s = sourceEl.value.trim();
    if(!r){ toast('Please select your role.'); return false; }
    if(!s){ toast('Please choose the transaction source.'); return false; }
    S.role=r; S.source=s; return true;
  }
  if(step===2){
    const f=firstNameEl.value.trim(), l=lastNameEl.value.trim(),
          e=emailEl.value.trim(), p=phoneEl.value.trim();
    if(!f || !l || !e || !p){ toast('Please complete your name, email, and phone.'); return false; }
    S.firstName=f; S.lastName=l; S.email=e; S.phone=p; return true;
  }
  if(step===3){
    S.itemDetails = itemDetailsEl.value.trim();
    return true;
  }
  return true;
}

/* ---------- submit handler (calls your backend) ---------- */
document.getElementById('submitBtn').addEventListener('click', async () => {
  if(S.step!==4){ return; }
  if(!validateStep(3)){ showStep(3); return; }

  try{
    const res = await fetch(`${API_BASE}/submit`, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({
        role: S.role,
        source: S.source,
        firstName: S.firstName,
        lastName: S.lastName,
        email: S.email,
        phone: S.phone,
        itemDetails: S.itemDetails,
        deliveryNotes: '' // optional
      })
    });
    const out = await res.json();
    if(!out.ok) throw new Error(out.error || 'Submit failed');

    S.orderId = out.orderId;
    showStep(5);
    hydrateSummary(out.invoiceUrl);
    toast('Submitted. Invoice emailed to the customer; notification sent to you.');
  }catch(err){
    console.error(err);
    // graceful fallback: still show summary with a local ID
    if(!S.orderId) S.orderId = genLocalOrderId();
    showStep(5);
    hydrateSummary(null);
    toast('Could not reach email service. Saved locally.');
  }
});

/* ---------- summary ---------- */
function hydrateSummary(invoiceUrl){
  if(!orderSummary) return;
  orderSummary.innerHTML = `
    <div style="background:#f9fbff;border:1px solid #e5e7eb;border-radius:12px;padding:12px">
      <div><b>Order ID:</b> ${S.orderId || '(pending)'}</div>
      <div><b>Role:</b> ${S.role} • <b>Source:</b> ${S.source||'(n/a)'}</div>
      <div><b>Name:</b> ${S.firstName} ${S.lastName} • <b>Email:</b> ${S.email}</div>
      <div><b>Phone:</b> ${S.phone}</div>
      <div><b>Item/Service:</b> ${S.itemDetails||'(none)'}</div>
      ${invoiceUrl ? `<div style="margin-top:8px"><a href="${invoiceUrl}" target="_blank" rel="noopener">Open invoice</a></div>` : ''}
    </div>`;
}

/* ---------- local fallback order id ---------- */
function genLocalOrderId(){
  const L='ABCDEFGHJKLMNPQRSTUVWXYZ', D='0123456789';
  let a=''; for(let i=0;i<3;i++) a+=L[Math.floor(Math.random()*L.length)];
  let b=''; for(let i=0;i<6;i++) b+=D[Math.floor(Math.random()*D.length)];
  return `${a}-${b}`;
}

/* ---------- footer year ---------- */
document.getElementById('yr').textContent = new Date().getFullYear();

/* ========================= Reviews (unchanged) ========================= */
const DEFAULT_REVIEWS = [
  { name:"Maya Chen (Austin, TX)", role:"Buyer", rating:5, text:"Clear updates at each step. Everything felt professional and secure.", verified:true },
  { name:"Michael Alvarez (Tampa, FL)", role:"Seller", rating:5, text:"Smooth and reliable service. Great peace of mind.", verified:true },
  { name:"Aisha Bello (Seattle, WA)", role:"Buyer", rating:5, text:"Easy to use, I felt protected as a buyer.", verified:true },
  { name:"Shannon Gaskins (Cleveland, OH)", role:"Buyer", rating:5, text:"Funds were only released after I confirmed delivery.", verified:true },
  { name:"William Roy (Denver, CO)", role:"Seller", rating:5, text:"Fast setup and clear process.", verified:true }
];
function loadReviews(){ try{ const raw=localStorage.getItem('SECURE_ESCROW_REVIEWS'); if(raw) return JSON.parse(raw);}catch(_){} return DEFAULT_REVIEWS.slice(); }
function saveReviews(list){ try{ localStorage.setItem('SECURE_ESCROW_REVIEWS', JSON.stringify(list)); }catch(_){} }
let REVIEWS = loadReviews();
function stars(n){ return '★★★★★'.slice(0,n) + '☆☆☆☆☆'.slice(0,5-n); }
function calcStats(){ const counts=[0,0,0,0,0,0]; REVIEWS.forEach(r=>{ counts[r.rating]=(counts[r.rating]||0)+1; }); const total=REVIEWS.length||0; const sum=REVIEWS.reduce((a,r)=>a+r.rating,0); const avg=total?(sum/total):0; return {counts,total,avg}; }
function renderStats(){ const {counts,total,avg}=calcStats(); document.getElementById('avgScore').textContent=avg.toFixed(1); document.getElementById('reviewCount').textContent = total===1? 'Based on 1 review' : `Based on ${total} reviews`; for(let r=1;r<=5;r++){ const pct=total?Math.round((counts[r]||0)/total*100):0; const el=document.getElementById('bar'+r); if(el) el.style.width=pct+'%'; } }
function renderReviews(){ const root=document.getElementById('reviews'); root.innerHTML=''; const show=window.innerWidth>820?3:1; const start=Math.floor(Date.now()/5000)%Math.max(1,REVIEWS.length); for(let i=0;i<show;i++){ const r=REVIEWS[(start+i)%REVIEWS.length]; const el=document.createElement('div'); el.className='review'; const verified=r.verified?'Verified customer':'Submitted review'; el.innerHTML=`<div class="stars" aria-label="${r.rating} out of 5">${stars(r.rating)}</div><div class="meta" style="margin-top:6px">${r.text}</div><div class="name">${r.name}</div><div class="meta">${r.role} • ${verified}</div>`; root.appendChild(el);} }
function hookupForm(){ const form=document.getElementById('reviewForm'); const nameEl=document.getElementById('revName'); const roleEl=document.getElementById('revRole'); const textEl=document.getElementById('revText'); const starWrap=document.getElementById('revStars'); let rating=5; starWrap.addEventListener('click',e=>{ const v=e.target&&e.target.dataset&&Number(e.target.dataset.v); if(!v) return; rating=v; [...starWrap.children].forEach((s,i)=> s.setAttribute('aria-checked', String(i+1===v))); }); starWrap.addEventListener('keydown',e=>{ if(e.key==='ArrowLeft'||e.key==='ArrowDown'){ rating=Math.max(1,rating-1); [...starWrap.children].forEach((s,i)=> s.setAttribute('aria-checked', String(i+1===rating))); } if(e.key==='ArrowRight'||e.key==='ArrowUp'){ rating=Math.min(5,rating+1); [...starWrap.children].forEach((s,i)=> s.setAttribute('aria-checked', String(i+1===rating))); } }); form.addEventListener('submit',e=>{ e.preventDefault(); const name=nameEl.value.trim(); const text=textEl.value.trim(); if(!name||!text){ alert('Please enter your name/city and a short comment.'); return; } const role=roleEl.value; const review={name,role,rating,text,verified:false}; REVIEWS.unshift(review); saveReviews(REVIEWS); nameEl.value=''; textEl.value=''; rating=5; [...starWrap.children].forEach((s,i)=> s.setAttribute('aria-checked', String(i===4))); renderStats(); renderReviews(); window.scrollTo({top: document.getElementById('reviews-section').offsetTop - 20, behavior:'smooth'}); }); }
renderStats(); renderReviews(); hookupForm(); window.addEventListener('resize', ()=> renderReviews());
</script>
</body>
</html>
